<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI SOC · 告警智能研判</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">
      <div class="logo">AI</div>
      <div class="brand-text">
        <div class="title">AI SOC</div>
        <div class="subtitle">告警智能研判 · 风险态势报告</div>
      </div>
    </div>
    <div class="top-actions">
      <a class="ghost" href="/docs" target="_blank">API Docs</a>
      <button id="btnReset" class="ghost">重置</button>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-left">
        <h1>上传告警数据，一键生成<span class="accent">高端</span>风险研判报告</h1>
        <p>
          支持 <b>CSV / XLSX / XLS</b>，自动识别字段并完成攻击类型识别、风险分级、画像统计与高风险样本预览。
        </p>

        <div class="upload-card">
          <div class="upload-row">
            <input id="fileInput" type="file" accept=".csv,.xlsx,.xls" />
            <button id="btnAnalyze" class="primary">生成报告</button>
            <button id="btnDownload" class="secondary" disabled>下载预测CSV</button>
          </div>

          <div class="hint">
            推荐字段：method / url_path / request_body / user_agent（用于分类）。有 src_ip / dst_ip / timestamp 报告更完整。
          </div>

          <div id="progressWrap" class="progress-wrap hidden">
            <div class="progress-bar"><div id="progressBar" class="progress"></div></div>
            <div id="progressText" class="progress-text">上传中...</div>
          </div>

          <div id="errorBox" class="error hidden"></div>
        </div>
      </div>

      <div class="hero-right">
        <div class="stat-card">
          <div class="stat-title">系统状态</div>
          <div class="stat-value" id="sysStatus">就绪</div>
          <div class="stat-sub">后端 API / 模型加载成功后可正常分析</div>
        </div>

        <div class="glass-card">
          <div class="mini-title">输出内容</div>
          <ul class="mini-list">
            <li>总体风险等级</li>
            <li>攻击类型分布</li>
            <li>Top 攻击源/目标/路径</li>
            <li>高风险样本预览</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="report" class="report hidden">
      <div class="report-head">
        <h2>风险研判报告</h2>
        <div class="pill" id="riskPill">—</div>
      </div>

      <div class="grid">
        <div class="card">
          <div class="card-head">
            <div class="card-title">总体统计</div>
          </div>
          <div class="metrics" id="metrics"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">攻击类型分布</div>
          </div>
          <div class="kv-table" id="typeCounts"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Top 攻击源 IP</div>
          </div>
          <div class="kv-table" id="topSrc"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Top 受攻击目标 IP</div>
          </div>
          <div class="kv-table" id="topDst"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Top 命中路径</div>
          </div>
          <div class="kv-table" id="topPath"></div>
        </div>

        <div class="card full">
          <div class="card-head">
            <div class="card-title">高风险样本预览（最多 20 条）</div>
          </div>
          <div class="table-wrap">
            <table class="table" id="highTable">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="table-foot">
            提示：正式作品展示 payload 时建议脱敏（只保留关键片段）。
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div>AI+安全 · 网络安全态势智能感知（Demo）</div>
    <div class="muted">FastAPI · 纯前端 · 本地推理</div>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
